-- Auto character wait
local Players = game:GetService("Players")
local player = Players.LocalPlayer

local function setup()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")

    -- Hook spoof table
    local spoofedValues = {
        WalkSpeed = humanoid.WalkSpeed,
        JumpPower = humanoid.JumpPower
    }

    -- Hook __index
    local mt = getrawmetatable(game)
    setreadonly(mt, false)
    local oldIndex = mt.__index

    mt.__index = newcclosure(function(self, key)
        if self == humanoid and spoofedValues[key] then
            return spoofedValues[key]
        end
        return oldIndex(self, key)
    end)
    setreadonly(mt, true)

    -- Create GUI
    local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
    gui.Name = "WSJP_GUI"
    gui.ResetOnSpawn = false

    -- Open Button
    local openButton = Instance.new("TextButton", gui)
    openButton.Size = UDim2.new(0, 160, 0, 50)
    openButton.Position = UDim2.new(0, 20, 0.5, -120)
    openButton.Text = "Open Speed Menu"
    openButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    openButton.TextColor3 = Color3.new(1, 1, 1)
    openButton.Font = Enum.Font.SourceSansBold
    openButton.TextSize = 20

    -- UICorner & Stroke for button
    local corner = Instance.new("UICorner", openButton)
    local stroke = Instance.new("UIStroke", openButton)
    stroke.Thickness = 2
    stroke.Color = Color3.fromRGB(255, 255, 255)

    -- Main Frame
    local mainFrame = Instance.new("Frame", gui)
    mainFrame.Size = UDim2.new(0, 250, 0, 230)
    mainFrame.Position = UDim2.new(0, 20, 0.5, -50)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.Visible = false
    mainFrame.Active = true
    mainFrame.Draggable = true

    local frameCorner = Instance.new("UICorner", mainFrame)
    local frameStroke = Instance.new("UIStroke", mainFrame)
    frameStroke.Thickness = 2
    frameStroke.Color = Color3.fromRGB(255, 255, 255)

    -- Layout
    local layout = Instance.new("UIListLayout", mainFrame)
    layout.Padding = UDim.new(0, 10)
    layout.SortOrder = Enum.SortOrder.LayoutOrder

    -- Padding
    local padding = Instance.new("UIPadding", mainFrame)
    padding.PaddingTop = UDim.new(0, 10)
    padding.PaddingLeft = UDim.new(0, 10)
    padding.PaddingRight = UDim.new(0, 10)

    -- TextBoxes
    local wsBox = Instance.new("TextBox", mainFrame)
    wsBox.Size = UDim2.new(1, 0, 0, 40)
    wsBox.PlaceholderText = "Enter WalkSpeed"
    wsBox.Text = ""
    wsBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    wsBox.TextColor3 = Color3.new(1, 1, 1)
    wsBox.Font = Enum.Font.SourceSans
    wsBox.TextSize = 18
    Instance.new("UICorner", wsBox)

    local jpBox = Instance.new("TextBox", mainFrame)
    jpBox.Size = UDim2.new(1, 0, 0, 40)
    jpBox.PlaceholderText = "Enter JumpPower"
    jpBox.Text = ""
    jpBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    jpBox.TextColor3 = Color3.new(1, 1, 1)
    jpBox.Font = Enum.Font.SourceSans
    jpBox.TextSize = 18
    Instance.new("UICorner", jpBox)

    -- Apply Button
    local applyBtn = Instance.new("TextButton", mainFrame)
    applyBtn.Size = UDim2.new(1, 0, 0, 40)
    applyBtn.Text = "Apply"
    applyBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
    applyBtn.TextColor3 = Color3.new(1, 1, 1)
    applyBtn.Font = Enum.Font.SourceSansBold
    applyBtn.TextSize = 20
    Instance.new("UICorner", applyBtn)

    -- Reset Button
    local resetBtn = Instance.new("TextButton", mainFrame)
    resetBtn.Size = UDim2.new(1, 0, 0, 40)
    resetBtn.Text = "Reset to Default"
    resetBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    resetBtn.TextColor3 = Color3.new(1, 1, 1)
    resetBtn.Font = Enum.Font.SourceSansBold
    resetBtn.TextSize = 18
    Instance.new("UICorner", resetBtn)

    -- Open toggle
    openButton.MouseButton1Click:Connect(function()
        mainFrame.Visible = not mainFrame.Visible
    end)

    -- Apply
    applyBtn.MouseButton1Click:Connect(function()
        local ws = tonumber(wsBox.Text)
        local jp = tonumber(jpBox.Text)

        if ws then
            humanoid.WalkSpeed = ws
            spoofedValues.WalkSpeed = ws
        end
        if jp then
            humanoid.JumpPower = jp
            spoofedValues.JumpPower = jp
        end
    end)

    -- Reset
    resetBtn.MouseButton1Click:Connect(function()
        humanoid.WalkSpeed = 16
        humanoid.JumpPower = 50
        spoofedValues.WalkSpeed = 16
        spoofedValues.JumpPower = 50
        wsBox.Text = ""
        jpBox.Text = ""
    end)
end

-- Run setup once
setup()

-- Auto-apply on respawn
player.CharacterAdded:Connect(function()
    task.wait(1) -- Give character time to load
    setup()
end)
